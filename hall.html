<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>æˆå°±æ®¿å ‚ Hall of Achievements | Snowwolf HUB</title>
<link rel="preload" as="audio" href="audio/hall_theme.mp3">
<link rel="preload" as="audio" href="sfx/click.wav">
<style>
:root{--ink:#e7eefb;--chip:#152238;--edge:#223553;}
*{box-sizing:border-box}html,body{height:100%;margin:0;background:#000;
  font-family:"PingFang TC","Noto Sans TC",sans-serif;color:var(--ink)}
.bg{position:fixed;inset:0;background:url("img/bg/hall_of_achievements.jpg") center/cover no-repeat;filter:brightness(.98) contrast(1.05)}
.shade{position:fixed;inset:0;pointer-events:none;background:radial-gradient(1200px 800px at 50% 20%,rgba(0,0,0,.08),rgba(0,0,0,.55) 70%)}
#snow,#mist{position:fixed;inset:0;pointer-events:none}
.topbar{position:fixed;left:18px;right:18px;top:12px;z-index:10;display:flex;gap:12px;align-items:center}
.chip{background:#152238;color:#cfe1ff;border:1px solid #223553;border-radius:999px;padding:8px 12px;font-size:13px;cursor:pointer}
.spacer{flex:1}
.hud{position:fixed;left:18px;right:18px;top:58px;z-index:9;display:flex;gap:24px;align-items:center}
.bar{width:210px}.bar label{display:block;font-size:12px;color:#b9c8e6;margin:0 0 4px 2px}
.meter{height:6px;background:#0d1830;border:1px solid #1e2c47;border-radius:999px;overflow:hidden}
.meter span{display:block;height:100%;background:linear-gradient(90deg,#4aa3ff,#9ad6ff)}
.wrap{position:fixed;left:50%;top:60%;transform:translate(-50%,-50%);z-index:6;width:min(1100px,92vw)}
.grid{display:grid;grid-template-columns:repeat(3,1fr);gap:14px}
.card{background:linear-gradient(180deg,#0e182bde,#0a1220e6);border:1px solid #1b2b47;border-radius:16px;backdrop-filter:blur(8px);padding:14px}
.card h4{margin:0 0 6px}
.p{font-size:13px;color:#c7d6f7;min-height:36px}
.badge{font-size:12px;padding:4px 8px;border:1px solid #27426e;border-radius:999px;background:#132744;margin-right:6px}
.btn{background:#173055;color:#e7f1ff;border:1px solid #27426e;border-radius:12px;padding:8px 12px;font-size:13px;cursor:pointer}
.btn[disabled]{opacity:.45;cursor:not-allowed}
.dialog{position:fixed;left:18px;right:18px;bottom:18px;z-index:7;background:linear-gradient(180deg,#0d1524e6,#0a111ee6);
  border:1px solid #1a2a44;border-radius:22px;padding:18px 22px;display:grid;grid-template-columns:88px 1fr auto;gap:18px;align-items:end}
.avatar img{width:88px;height:88px;border-radius:16px;object-fit:cover;border:1px solid #273a5a}
#returnGame{position:fixed;right:28px;bottom:108px;z-index:8;background:#173055;border:1px solid #2a4b7a;border-radius:50%;width:68px;height:68px;display:flex;align-items:center;justify-content:center;font-size:26px;box-shadow:0 0 20px #9ad6ff80;cursor:pointer}
.toast{position:fixed;right:18px;bottom:18px;background:#0c1a30;border:1px solid #234168;border-radius:12px;padding:10px 14px;display:none;z-index:50}
@media(max-width:960px){.grid{grid-template-columns:1fr}}
</style>
</head>
<body>
<canvas id="snow"></canvas><canvas id="mist"></canvas>
<div class="bg"></div><div class="shade"></div>

<div class="topbar">
  <button class="chip" data-jump="school.html">ğŸ« å›å­¸æ ¡</button>
  <button class="chip" data-jump="wardrobe.html">ğŸ§¥ è¡£æ«ƒ</button>
  <button class="chip" data-jump="bag.html">ğŸ’ é“å…·</button>
  <div class="spacer"></div>
  <div class="chip">ğŸ’° é‡‘å¹£ <b id="coins">0</b></div>
  <button id="bgmBtn" class="chip">BGMï¼šé–‹</button>
</div>

<div class="hud">
  <div class="bar"><label>å‹‡æ°£ Courage</label><div class="meter"><span id="mC" style="width:0%"></span></div></div>
  <div class="bar"><label>åŒç† Empathy</label><div class="meter"><span id="mE" style="width:0%"></span></div></div>
  <div class="bar"><label>çœŸå¯¦ Truth</label><div class="meter"><span id="mT" style="width:0%"></span></div></div>
</div>

<div class="wrap">
  <div class="grid" id="achvGrid"></div>
</div>

<div class="dialog">
  <div class="avatar"><img id="ava" src="img/avatars/principal.png" alt=""></div>
  <div>
    <div id="who" style="font-weight:700;font-size:18px">æ ¡é•·</div>
    <div id="line" class="line">ã€Œæ¯ä¸€æšå¾½ç« ï¼Œéƒ½è¨˜éŒ„ä½ æˆç‚ºæ›´å¥½çš„è‡ªå·±çš„ç¬é–“ã€‚ã€</div>
  </div>
  <button id="next" class="btn">ä¸‹ä¸€å¥ â–¶</button>
</div>

<div id="returnGame" title="å›åˆ°å†’éšª">ğŸ”ï¸</div>
<div id="toast" class="toast"></div>

<audio id="bgm" src="audio/hall_theme.mp3" loop></audio>
<audio id="sfx" src="sfx/click.wav" preload="auto"></audio>

<script>
const $=q=>document.querySelector(q);const SFX=$('#sfx');
const toast=t=>{const n=$('#toast');n.textContent=t;n.style.display='block';setTimeout(()=>n.style.display='none',1200);}
function sfx(){try{SFX.currentTime=0;SFX.play();}catch{}}

const state={
  coins:Number(localStorage.getItem('coins')||140),
  C:+localStorage.getItem('stat_C')||24,
  E:+localStorage.getItem('stat_E')||18,
  T:+localStorage.getItem('stat_T')||12,
  bag:JSON.parse(localStorage.getItem('bag')||'[]'),
  quests:Object.values(JSON.parse(localStorage.getItem('quests_courtyard_v1')||'{}'))
};
const mm={C:$('#mC'),E:$('#mE'),T:$('#mT')};
function syncHUD(){
  $('#coins').textContent=state.coins;
  mm.C.style.width=Math.min(state.C,100)+'%';
  mm.E.style.width=Math.min(state.E,100)+'%';
  mm.T.style.width=Math.min(state.T,100)+'%';
  localStorage.setItem('coins',state.coins);
  localStorage.setItem('stat_C',state.C);
  localStorage.setItem('stat_E',state.E);
  localStorage.setItem('stat_T',state.T);
}
syncHUD();

// æˆå°±è³‡æ–™
const ACHV_KEY='achievements_claimed_v1';
let CLAIMED=new Set(JSON.parse(localStorage.getItem(ACHV_KEY)||'[]'));

const ACHV=[
  {id:'a_quest1', title:'åˆæ¢è€… Novice Explorer', desc:'å®Œæˆä»»å‹™ Ã—1', test:()=>state.quests.filter(Boolean).length>=1, reward:()=>{state.coins+=20;}},
  {id:'a_courage30', title:'æ–°ç”Ÿä¹‹å‹‡ Budding Courage', desc:'å‹‡æ°£ â‰¥ 30', test:()=>state.C>=30, reward:()=>{state.C+=2;}},
  {id:'a_empathy30', title:'æº«æš–ä¹‹å¿ƒ Warm Heart', desc:'åŒç† â‰¥ 30', test:()=>state.E>=30, reward:()=>{state.E+=2;}},
  {id:'a_truth30', title:'æ±‚çœŸçš„äºº Seeker of Truth', desc:'çœŸå¯¦ â‰¥ 30', test:()=>state.T>=30, reward:()=>{state.T+=2;}},
  {id:'a_collector3', title:'æ”¶è—å®¶ Collector', desc:'èƒŒåŒ…é“å…· â‰¥ 3', test:()=>state.bag.length>=3, reward:()=>{state.coins+=30;}},
  {id:'a_patron200', title:'å°å°è´ŠåŠ©è€… Patron', desc:'é‡‘å¹£ â‰¥ 200', test:()=>state.coins>=200, reward:()=>{state.bag.push('æ¦®è€€å¾½ç« ');}}
];

function render(){
  const g=$('#achvGrid'); g.innerHTML='';
  ACHV.forEach(a=>{
    const ok=a.test(); const claimed=CLAIMED.has(a.id);
    const card=document.createElement('div'); card.className='card';
    card.innerHTML=`
      <h4>${a.title} ${claimed?'ğŸ…':''}</h4>
      <div class="p">${a.desc}</div>
      <div style="margin-bottom:8px">
        <span class="badge">å‹‡æ°£ ${state.C}</span>
        <span class="badge">åŒç† ${state.E}</span>
        <span class="badge">çœŸå¯¦ ${state.T}</span>
        <span class="badge">ä»»å‹™ ${state.quests.filter(Boolean).length}</span>
        <span class="badge">é“å…· ${state.bag.length}</span>
        <span class="badge">é‡‘å¹£ ${state.coins}</span>
      </div>
      <button class="btn" data-id="${a.id}" ${!ok||claimed?'disabled':''}>${claimed?'å·²é ˜å–':'é ˜å–çå‹µ'}</button>
    `;
    g.appendChild(card);
  });
}
render();

$('#achvGrid').addEventListener('click',e=>{
  const b=e.target.closest('button'); if(!b) return; sfx();
  const id=b.dataset.id; const a=ACHV.find(x=>x.id===id);
  if(CLAIMED.has(id)) return;
  if(!a.test()) return toast('å°šæœªé”æˆæ¢ä»¶');
  a.reward(); CLAIMED.add(id);
  localStorage.setItem(ACHV_KEY,JSON.stringify([...CLAIMED]));
  syncHUD(); render(); toast('å·²é ˜å–çå‹µï¼');
});

// å°è©±è¼ªæ’­
const talk=[
  {n:'æ ¡é•·',a:'img/avatars/principal.png',t:'ã€Œæ¯ä¸€æšå¾½ç« ï¼Œéƒ½è¨˜éŒ„ä½ æˆç‚ºæ›´å¥½çš„è‡ªå·±çš„ç¬é–“ã€‚ã€'},
  {n:'ç³»çµ±',a:'img/avatars/system_core.png',t:'æç¤ºï¼šé”æˆæ¢ä»¶å¾ŒæŒ‰ä¸‹ã€Œé ˜å–çå‹µã€ï¼Œæœƒç«‹å³åŠ åˆ°å±¬æ€§ï¼é‡‘å¹£ï¼èƒŒåŒ…ã€‚'},
  {n:'è‰¾è–©å…‹',a:'img/avatars/isaac.png',t:'ã€Œçœ‹èµ·ä¾†é‚„æœ‰å¾ˆå¤šå¯ä»¥æŒ‘æˆ°çš„ï¼Œèµ°å§ï¼ã€'}
];let ti=0;
function say(o){$('#who').textContent=o.n;$('#line').textContent=o.t;$('#ava').src=o.a}
$('#next').onclick=()=>{sfx();say(talk[ti++%talk.length])}; say(talk[0]);

// å°è¦½ & BGM
document.querySelectorAll('[data-jump]').forEach(b=>b.addEventListener('click',()=>{sfx();location.href=b.dataset.jump;}));
$('#returnGame').onclick=()=>{sfx();location.href='mission_snow_temple.html';};
const bgm=$('#bgm'); function play(){try{bgm.volume=.8;bgm.play();}catch{}} play();
$('#bgmBtn').onclick=()=>{sfx(); if(bgm.paused){play();$('#bgmBtn').textContent='BGMï¼šé–‹';}else{bgm.pause();$('#bgmBtn').textContent='BGMï¼šé—œ';}};

// é£„é›ªèˆ‡è–„éœ§
(function snow(){const c=$('#snow'),x=c.getContext('2d');function rs(){c.width=innerWidth;c.height=innerHeight}
addEventListener('resize',rs);rs();const a=Array.from({length:160},()=>({x:Math.random()*c.width,y:Math.random()*c.height,r:Math.random()*2+0.9,v:Math.random()*0.6+0.3}));
(function loop(){x.clearRect(0,0,c.width,c.height);x.fillStyle='rgba(230,245,255,.9)';
a.forEach(f=>{f.y+=f.v;f.x+=Math.sin(f.y*0.01)*0.2;if(f.y>c.height){f.y=-10;f.x=Math.random()*c.width}x.beginPath();x.arc(f.x,f.y,f.r,0,Math.PI*2);x.fill();});
requestAnimationFrame(loop);})();})();
(function mist(){const c=$('#mist'),ctx=c.getContext('2d');function rs(){c.width=innerWidth;c.height=innerHeight}addEventListener('resize',rs);rs();let t=0;
(function loop(){t+=0.003;ctx.clearRect(0,0,c.width,c.height);for(let i=0;i<3;i++){const g=ctx.createRadialGradient((Math.sin(t+i)*0.3+0.5)*c.width,(Math.cos(t*0.8+i)*0.2+0.8)*c.height,0,(Math.sin(t+i)*0.3+0.5)*c.width,(Math.cos(t*0.8+i)*0.2+0.8)*c.height,Math.min(c.width,c.height)*.6);g.addColorStop(0,'rgba(120,170,220,0.06)');g.addColorStop(1,'rgba(120,170,220,0)');ctx.fillStyle=g;ctx.fillRect(0,0,c.width,c.height);}requestAnimationFrame(loop);})();})();
</script>
</body>
</html>
