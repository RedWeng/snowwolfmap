<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>é›ªç‹¼ç”·å­©ï¼šè‰¾è–©å…‹ä¹‹å®¶ - åœ°ä¸‹å®¤ç¯‡ v4.2</title>

<style>
body {
  margin: 0;
  font-family: "Noto Sans TC", sans-serif;
  color: #fff;
  background: #000;
  overflow: hidden;
}

/* === èƒŒæ™¯å½±ç‰‡ === */
#bgVideo {
  position: fixed;
  inset: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  filter: brightness(1.05) contrast(1.1);
  z-index: 0;
}

/* === ç…™éœ§ + ç²’å­ === */
#fog {
  position: fixed;
  inset: 0;
  background: radial-gradient(circle at 50% 60%, rgba(120,160,200,0.25), transparent 70%);
  mix-blend-mode: screen;
  opacity: 0.4;
  animation: fogMove 12s ease-in-out infinite alternate;
  z-index: 1;
}
@keyframes fogMove {
  from { transform: translateX(-2%) scale(1.02); opacity: 0.3; }
  to { transform: translateX(3%) scale(1.04); opacity: 0.5; }
}
#particles {
  position: fixed;
  inset: 0;
  z-index: 2;
  pointer-events: none;
}
.p {
  position: absolute;
  width: 3px;
  height: 3px;
  background: #9cf;
  border-radius: 50%;
  opacity: 0.6;
  animation: fall 14s linear infinite;
}
@keyframes fall {
  0% { transform: translateY(-10vh) translateX(0); }
  100% { transform: translateY(110vh) translateX(var(--dx, 30px)); opacity: 0; }
}

/* === å°è¦½åˆ— === */
.topbar {
  position: fixed;
  top: 10px;
  left: 50%;
  transform: translateX(-50%);
  display: flex;
  gap: 10px;
  background: rgba(50,70,100,0.45);
  padding: 6px 12px;
  border-radius: 12px;
  backdrop-filter: blur(6px);
  z-index: 100;
}
.chip {
  background: rgba(255,255,255,0.12);
  border: 1px solid rgba(255,255,255,0.3);
  color: #fff;
  padding: 6px 12px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.3s;
}
.chip:hover { background: rgba(255,255,255,0.25); transform: translateY(-2px); }

/* === HUD === */
#hud {
  position: fixed;
  top: 10px;
  right: 10px;
  display: flex;
  gap: 10px;
  z-index: 100;
}
.attr {
  background: rgba(255,255,255,0.1);
  border: 1px solid rgba(255,255,255,0.2);
  padding: 4px 12px;
  border-radius: 12px;
  font-size: 15px;
}

/* === å°è©±æ¡† === */
#dialogueBox {
  position: fixed;
  bottom: 0;
  left: 0;
  width: 100%;
  background: rgba(20,30,60,0.78);
  padding: 20px;
  line-height: 1.6;
  backdrop-filter: blur(8px);
  display: none;
  z-index: 90;
}
#dialogueCharacter { font-weight: bold; color: #ffd; margin-bottom: 6px; }
#dialogueText { margin-right: 100px; font-size: 15px; }
#nextBtn {
  position: absolute;
  right: 120px;
  bottom: 24px;
  background: rgba(255,255,255,0.12);
  border: 1px solid rgba(255,255,255,0.3);
  color: #fff;
  padding: 6px 14px;
  border-radius: 8px;
  cursor: pointer;
  font-size: 14px;
  transition: all 0.25s ease;
}

/* === ä»»å‹™æ¡† === */
#questBox {
  position: fixed;
  right: 20px;
  bottom: 120px;
  background: rgba(30,40,60,0.85);
  border: 1px solid rgba(255,255,255,0.3);
  border-radius: 12px;
  padding: 10px 16px;
  display: none;
  z-index: 100;
  transition: all 0.4s ease;
}
#toggleQuest {
  position: fixed;
  right: 20px;
  bottom: 20px;
  background: rgba(255,255,255,0.12);
  border: 1px solid rgba(255,255,255,0.3);
  color: #fff;
  padding: 8px 16px;
  border-radius: 8px;
  cursor: pointer;
  z-index: 100;
}

/* === å…‰çƒèˆ‡é‡‘å±¬ç®± === */
.hotspot {
  position: absolute;
  cursor: pointer;
  transition: all 0.3s ease;
  z-index: 5;
}
.hotspot:hover {
  transform: scale(1.1);
  filter: drop-shadow(0 0 12px rgba(120,255,255,0.8));
}
#core {
  top: 56%;
  left: 47%;
  width: 12%;
  height: 22%;
  background: url('images/hotspot_core.png') center/contain no-repeat;
  opacity: 0.85;
  animation: corePulse 3s ease-in-out infinite;
}
#box {
  top: 74%;
  left: 30%;
  width: 14%;
  height: 16%;
  background: url('images/hotspot_box.png') center/contain no-repeat;
  opacity: 0.9;
}
@keyframes corePulse {
  0%,100% { filter: drop-shadow(0 0 6px #8ff) brightness(1); }
  50% { filter: drop-shadow(0 0 18px #adf) brightness(1.3); }
}
</style>
</head>

<body>
<video id="bgVideo" autoplay loop muted playsinline>
  <source src="video/isaac_basement.mp4" type="video/mp4">
</video>

<div id="fog"></div>
<div id="particles"></div>

<div class="topbar">
  <button class="chip" data-jump="isaac_home_study.html">â¬†ï¸ å›æ›¸æˆ¿</button>
  <button class="chip" data-jump="wardrobe.html">ğŸ§¥ è¡£æ«ƒ</button>
  <button class="chip" data-jump="inventory.html">ğŸ’ é“å…·</button>
  <button id="bgmBtn" class="chip">ğŸ”Š BGM é–‹</button>
</div>

<div id="hud">
  <div class="attr"><span>å‹‡æ°£</span><b>0</b></div>
  <div class="attr"><span>åŒç†</span><b>0</b></div>
  <div class="attr"><span>çœŸå¯¦</span><b>0</b></div>
</div>

<div id="dialogueBox">
  <div id="dialogueCharacter"></div>
  <div id="dialogueText"></div>
  <button id="nextBtn">ä¸‹ä¸€å¥ â–¶</button>
</div>

<div id="questBox"><h4>ä»»å‹™ Quest</h4><ul id="questList"></ul></div>
<button id="toggleQuest">ğŸ“œ ä»»å‹™</button>

<!-- ç†±å€äº’å‹• -->
<div id="core" class="hotspot" title="è¨˜æ†¶æ ¸å¿ƒ"></div>
<div id="box" class="hotspot" title="èˆŠé‡‘å±¬ç®±"></div>

<script>
window.addEventListener("DOMContentLoaded",()=>{
  // === ç²’å­ ===
  const pC=document.getElementById("particles");
  for(let i=0;i<35;i++){
    const d=document.createElement("div");
    d.className="p";
    d.style.left=Math.random()*100+"vw";
    d.style.animationDelay=Math.random()*8+"s";
    d.style.setProperty("--dx",(Math.random()*40-20)+"px");
    pC.appendChild(d);
  }

  // === éŸ³æ¨‚ ===
  const bgm=new Audio("audio/bgm_basement.mp3");
  bgm.loop=true; bgm.volume=0.4;
  const start=()=>{bgm.play().catch(()=>{});document.body.removeEventListener("click",start);}
  document.body.addEventListener("click",start);

  // === æŒ‰éˆ•å°å‘ ===
  document.querySelectorAll("[data-jump]").forEach(btn=>{
    btn.onclick=()=>window.open(btn.dataset.jump,"_self");
  });

  // === ä»»å‹™æ¡† ===
  const questBox=document.getElementById("questBox");
  document.getElementById("toggleQuest").onclick=()=>{
    questBox.style.display=(questBox.style.display==="block")?"none":"block";
  };

  // === å°è©± ===
  const dialogueBox=document.getElementById("dialogueBox");
  const charEl=document.getElementById("dialogueCharacter");
  const textEl=document.getElementById("dialogueText");
  const lines=[
    {n:"è‰¾è–©å…‹",t:"é€™è£¡â€¦â€¦å¥½é»‘ã€‚é›»åŠ›ç³»çµ±å¹¾ä¹å£äº†ã€‚"},
    {n:"è‰¾è–©å…‹",t:"çˆ¶è¦ªå¸¸èªªï¼Œã€å…‰æœƒè¨˜å¾—é‚£äº›ç›¸ä¿¡å®ƒçš„äººã€â€¦â€¦"},
    {n:"ç³»çµ±",t:"ä»»å‹™æ›´æ–°ï¼šèª¿æŸ¥è¨˜æ†¶æ ¸å¿ƒèˆ‡èˆŠé‡‘å±¬ç®±ã€‚"}
  ];
  let index=0;
  dialogueBox.style.display="block";
  function showLine(){
    const line=lines[index];
    if(!line){ dialogueBox.style.display="none"; return; }
    charEl.textContent=line.n;
    textEl.textContent="";
    let i=0;
    const typer=setInterval(()=>{
      textEl.textContent=line.t.slice(0,i++);
      if(i>line.t.length) clearInterval(typer);
    },40);
  }
  showLine();
  document.getElementById("nextBtn").onclick=()=>{index++;showLine();};
});
</script>
</body>
</html>
